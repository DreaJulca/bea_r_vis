#scale_numeric("y", trans = "log")
p_iris
?file.copy
p_iris <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width, fill = ~Species) %>%
layer_points() %>%
#	scale_numeric("x") %>%
#	scale_numeric("y")
layer_model_predictions(model = "lm", se = TRUE) %>%
scale_numeric("x", trans = "log") %>%
scale_numeric("y", trans = "log")
p_iris <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width, fill = ~Species) %>%
layer_points() %>%
#	scale_numeric("x") %>%
#	scale_numeric("y")
#	layer_model_predictions(model = "lm", se = TRUE) %>%
scale_numeric("x", trans = "log") %>%
scale_numeric("y", trans = "log")
p_iris
p_iris <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width, fill = ~Species) %>%
layer_points() %>%
#	scale_numeric("x") %>%
#	scale_numeric("y")
layer_smooths(span = 0.3, stroke := "red") %>%
layer_model_predictions(model = "lm", se = TRUE) %>%
scale_numeric("x", trans = "log") %>%
scale_numeric("y", trans = "log")
p_iris <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width, fill = ~Species) %>%
layer_points() %>%
scale_numeric("x") %>%
scale_numeric("y")
p_iris_smooth <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width) %>%
layer_points() %>%
layer_smooths(span = 0.3, stroke := "red") %>%
layer_model_predictions(model = "lm", se = TRUE) %>%
scale_numeric("x", trans = "log") %>%
scale_numeric("y", trans = "log")
p_iris
p_iris_smooth
p_iris <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width, fill = ~Species) %>%
layer_points() %>%
scale_numeric("x") %>%
scale_numeric("y")
p_iris_smooth <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width) %>%
layer_points() %>%
#layer_smooths(span = 0.3, stroke := "red") %>%
layer_model_predictions(model = "lm", se = TRUE) %>%
scale_numeric("x", trans = "log") %>%
scale_numeric("y", trans = "log")
p_iris_smooth
p_iris <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width, fill = ~Species) %>%
layer_points() %>%
scale_numeric("x") %>%
scale_numeric("y")%>%
add_tooltip(function(df) df$Sepal.Length)
p_iris_smooth <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width) %>%
layer_points() %>%
layer_smooths(span = 0.3, stroke := "red") %>%
layer_model_predictions(model = "lm", se = TRUE) %>%
scale_numeric("x", trans = "log") %>%
scale_numeric("y", trans = "log")
p_iris
p_iris <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width, fill = ~Species) %>%
layer_points() %>%
scale_numeric("x") %>%
scale_numeric("y")%>%
add_tooltip(function(d){return(paste0('Sepal Length: ', d$Sepal.Length, '\nSepal Width: ', d$Sepal.Width))})
p_iris_smooth <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width) %>%
layer_points() %>%
layer_smooths(span = 0.3, stroke := "red") %>%
layer_model_predictions(model = "lm", se = TRUE) %>%
scale_numeric("x", trans = "log") %>%
scale_numeric("y", trans = "log")
p_iris
p_iris <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width, fill = ~Species) %>%
layer_points() %>%
scale_numeric("x") %>%
scale_numeric("y")%>%
add_tooltip(function(d){return(paste0('Sepal Length: ', d$Sepal.Length, '<br>Sepal Width: ', d$Sepal.Width))})
p_iris_smooth <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width) %>%
layer_points() %>%
layer_smooths(span = 0.3, stroke := "red") %>%
layer_model_predictions(model = "lm", se = TRUE) %>%
scale_numeric("x", trans = "log") %>%
scale_numeric("y", trans = "log")
p_iris
p_iris <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width, fill = ~Species) %>%
layer_points() %>%
scale_numeric("x") %>%
scale_numeric("y")%>%
add_tooltip(function(d){return(paste0('Sepal Length: ', d$Sepal.Length, '<br>Sepal Width: ', d$Sepal.Width))}) #Use HTML
p_iris_smooth <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width) %>%
layer_points() %>%
layer_smooths(span = 0.3, stroke := "red") %>%
layer_model_predictions(model = "lm", se = TRUE) %>%
scale_numeric("x", trans = "log") %>%
scale_numeric("y", trans = "log") %>%
add_tooltip(function(d){return(paste0('Species: ', d$Species, '<br>Sepal Length: ', d$Sepal.Length, '<br>Sepal Width: ', d$Sepal.Width))}) #Use HTML
p_iris_smooth
getTooltipVals <- function(d){
#Uses HTML
return(paste0('Species: ', d$Species, '<br>Sepal Length: ', d$Sepal.Length, '<br>Sepal Width: ', d$Sepal.Width))
}
p_iris <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width, fill = ~Species) %>%
layer_points() %>%
scale_numeric("x") %>%
scale_numeric("y")%>%
add_tooltip(function(d){
return(getTooltipVals(d))
}) #Use HTML
p_iris_smooth <- iris %>%
ggvis(x = ~Sepal.Length, y = ~Sepal.Width) %>%
layer_points() %>%
layer_smooths(span = 0.3, stroke := "red") %>%
layer_model_predictions(model = "lm", se = TRUE) %>%
scale_numeric("x", trans = "log") %>%
scale_numeric("y", trans = "log") %>%
add_tooltip(getTooltipVals)
p_iris_smooth
p_iris
cocaine
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
layer_line(size = ~Dollars/~Population, color = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_line(size = 1.05) %>%
layer_smooths(method = "loess") %>% # Our stats layer
scale_numeric("y", labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x", breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, label=~label,   #Add our text annotations AFTER all other
color="black", size=3 , angle=45,                          #  geoms so it is on top of all other marks
fontface="bold", hjust = 1) +
labs(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
subtitle = "Total [Billions], Per Capita, and Projection") +
theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
plot.title = element_text(hjust = 0.5),          #Center chart title
plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
layer_lines(size = ~Dollars/~Population, color = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines(size = 1.05) %>%
layer_smooths(method = "loess") %>% # Our stats layer
scale_numeric("y", labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x", breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, label=~label,   #Add our text annotations AFTER all other
color="black", size=3 , angle=45,                          #  geoms so it is on top of all other marks
fontface="bold", hjust = 1) +
labs(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
subtitle = "Total [Billions], Per Capita, and Projection") +
theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
plot.title = element_text(hjust = 0.5),          #Center chart title
plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
layer_lines(size = ~Dollars/Population, color = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines(size = 1.05) %>%
layer_smooths(method = "loess") %>% # Our stats layer
scale_numeric("y", labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x", breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, label=~label,   #Add our text annotations AFTER all other
color="black", size=3 , angle=45,                          #  geoms so it is on top of all other marks
fontface="bold", hjust = 1) +
labs(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
subtitle = "Total [Billions], Per Capita, and Projection") +
theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
plot.title = element_text(hjust = 0.5),          #Center chart title
plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
layer_lines(size = ~Dollars/Population, stroke = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines(size = 1.05) %>%
layer_smooths(method = "loess") %>% # Our stats layer
scale_numeric("y", labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x", breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, label=~label,   #Add our text annotations AFTER all other
color="black", size=3 , angle=45,                          #  geoms so it is on top of all other marks
fontface="bold", hjust = 1) +
labs(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
subtitle = "Total [Billions], Per Capita, and Projection") +
theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
plot.title = element_text(hjust = 0.5),          #Center chart title
plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
#layer_lines(size = ~Dollars/Population, stroke = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines() %>%
layer_smooths(method = "loess") %>% # Our stats layer
scale_numeric("y", labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x", breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, label=~label,   #Add our text annotations AFTER all other
color="black", size=3 , angle=45,                          #  geoms so it is on top of all other marks
fontface="bold", hjust = 1) +
labs(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
subtitle = "Total [Billions], Per Capita, and Projection") +
theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
plot.title = element_text(hjust = 0.5),          #Center chart title
plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
?layer_smooths)()
?layer_smooths()
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
#layer_lines(size = ~Dollars/Population, stroke = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines() %>%
layer_smooths() %>% # Our stats layer; ggvis actually defaults to LOESS
scale_numeric("y", labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x", breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, label=~label,   #Add our text annotations AFTER all other
color="black", size=3 , angle=45,                          #  geoms so it is on top of all other marks
fontface="bold", hjust = 1) +
labs(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
subtitle = "Total [Billions], Per Capita, and Projection") +
theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
plot.title = element_text(hjust = 0.5),          #Center chart title
plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
#layer_lines(size = ~Dollars/Population, stroke = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines() %>%
layer_smooths() %>% # Our stats layer; ggvis actually defaults to LOESS
layer_model_predictions(model = "loess", se = TRUE) %>%
scale_numeric("y", labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x", breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, label=~label,   #Add our text annotations AFTER all other
color="black", size=3 , angle=45,                          #  geoms so it is on top of all other marks
fontface="bold", hjust = 1) +
labs(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
subtitle = "Total [Billions], Per Capita, and Projection") +
theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
plot.title = element_text(hjust = 0.5),          #Center chart title
plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
#layer_lines(size = ~Dollars/Population, stroke = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines() %>%
layer_smooths(span = 1, stroke := "red") %>% # Our stats layer; ggvis actually defaults to LOESS
layer_model_predictions(model = "loess", se = TRUE) %>%
scale_numeric("y", labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x", breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, label=~label,   #Add our text annotations AFTER all other
color="black", size=3 , angle=45,                          #  geoms so it is on top of all other marks
fontface="bold", hjust = 1) +
labs(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
subtitle = "Total [Billions], Per Capita, and Projection") +
theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
plot.title = element_text(hjust = 0.5),          #Center chart title
plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
#layer_lines(size = ~Dollars/Population, stroke = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines() %>%
#  layer_smooths(span = 1, stroke := "red") %>% # Our stats layer; ggvis actually defaults to LOESS
#	layer_model_predictions(model = "loess", se = TRUE) %>%
scale_numeric("y", labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x", breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, label=~label,   #Add our text annotations AFTER all other
color="black", size=3 , angle=45,                          #  geoms so it is on top of all other marks
fontface="bold", hjust = 1) +
labs(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
subtitle = "Total [Billions], Per Capita, and Projection") +
theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
plot.title = element_text(hjust = 0.5),          #Center chart title
plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
source('~/.active-rstudio-document', echo=TRUE)
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
#layer_lines(size = ~Dollars/Population, stroke = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines() %>%
#  layer_smooths(span = 1, stroke := "red") %>% # Our stats layer; ggvis actually defaults to LOESS
#	layer_model_predictions(model = "loess", se = TRUE) %>%
scale_numeric("y") %>% #, labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x", breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, label=~label,   #Add our text annotations AFTER all other
color="black", size=3 , angle=45,                          #  geoms so it is on top of all other marks
fontface="bold", hjust = 1) +
labs(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
subtitle = "Total [Billions], Per Capita, and Projection") +
theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
plot.title = element_text(hjust = 0.5),          #Center chart title
plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
#layer_lines(size = ~Dollars/Population, stroke = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines() %>%
#  layer_smooths(span = 1, stroke := "red") %>% # Our stats layer; ggvis actually defaults to LOESS
#	layer_model_predictions(model = "loess", se = TRUE) %>%
scale_numeric("y") %>% #, labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x") %>% #, breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, label=~label,   #Add our text annotations AFTER all other
color="black", size=3 , angle=45,                          #  geoms so it is on top of all other marks
fontface="bold", hjust = 1) +
labs(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
subtitle = "Total [Billions], Per Capita, and Projection") +
theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
plot.title = element_text(hjust = 0.5),          #Center chart title
plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
annotation <- data.frame(
Period = c("2007Q4","2009Q2", "2020Q2"),
Dollars = c(20000,10000, 25000),
label = c("Start of G.R.", "End of G.R.", "COVID Recession")
)
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
#layer_lines(size = ~Dollars/Population, stroke = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines() %>%
#  layer_smooths(span = 1, stroke := "red") %>% # Our stats layer; ggvis actually defaults to LOESS
#	layer_model_predictions(model = "loess", se = TRUE) %>%
scale_numeric("y") %>% #, labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x") %>% #, breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, label=~label,   #Add our text annotations AFTER all other
color="black", size=3 , angle=45,                          #  geoms so it is on top of all other marks
fontface="bold", hjust = 1) +
labs(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
subtitle = "Total [Billions], Per Capita, and Projection") +
theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
plot.title = element_text(hjust = 0.5),          #Center chart title
plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
annotation <- data.frame(
Period = c("2007Q4","2009Q2", "2020Q2"),
Dollars = c(20000,10000, 25000),
label = c("Start of G.R.", "End of G.R.", "COVID Recession")
)
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
#layer_lines(size = ~Dollars/Population, stroke = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines() %>%
#  layer_smooths(span = 1, stroke := "red") %>% # Our stats layer; ggvis actually defaults to LOESS
#	layer_model_predictions(model = "loess", se = TRUE) %>%
scale_numeric("y") %>% #, labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x") %>% #, breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, baseline=~label,   #Add our text annotations AFTER all other
stroke="black", fontSize=3 , #angle=45,                          #  geoms so it is on top of all other marks
fontface="bold", hjust = 1) +
labs(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
subtitle = "Total [Billions], Per Capita, and Projection") +
theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
plot.title = element_text(hjust = 0.5),          #Center chart title
plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
annotation <- data.frame(
Period = c("2007Q4","2009Q2", "2020Q2"),
Dollars = c(20000,10000, 25000),
label = c("Start of G.R.", "End of G.R.", "COVID Recession")
)
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
#layer_lines(size = ~Dollars/Population, stroke = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines() %>%
#  layer_smooths(span = 1, stroke := "red") %>% # Our stats layer; ggvis actually defaults to LOESS
#	layer_model_predictions(model = "loess", se = TRUE) %>%
scale_numeric("y") %>% #, labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x") %>% #, breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, baseline=~label,   #Add our text annotations AFTER all other
stroke="black", fontSize=3 , angle=45) %>% #,                          #  geoms so it is on top of all other marks
#            fontface="bold", hjust = 1) +
labs(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
subtitle = "Total [Billions], Per Capita, and Projection") +
theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
plot.title = element_text(hjust = 0.5),          #Center chart title
plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
annotation <- data.frame(
Period = c("2007Q4","2009Q2", "2020Q2"),
Dollars = c(20000,10000, 25000),
label = c("Start of G.R.", "End of G.R.", "COVID Recession")
)
add_title <- function(vis, ..., x_lab = "X units", title = "Plot Title")
{
add_axis(vis, "x", title = x_lab) %>%
add_axis("x", orient = "top", ticks = 0, title = title,
properties = axis_props(
axis = list(stroke = "white"),
labels = list(fontSize = 0)
), ...)
}
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
#layer_lines(size = ~Dollars/Population, stroke = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines() %>%
#  layer_smooths(span = 1, stroke := "red") %>% # Our stats layer; ggvis actually defaults to LOESS
#	layer_model_predictions(model = "loess", se = TRUE) %>%
scale_numeric("y") %>% #, labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x") %>% #, breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, baseline=~label,   #Add our text annotations AFTER all other
stroke="black", fontSize=3 , angle=45) %>% #,                          #  geoms so it is on top of all other marks
#            fontface="bold", hjust = 1) +
add_title(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
x_lab = "Total [Billions], Per Capita, and Projection") #+
#  theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
#        plot.title = element_text(hjust = 0.5),          #Center chart title
#        plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
p
p
annotation <- data.frame(
Period = c("2007Q4","2009Q2", "2020Q2"),
Dollars = c(20000,10000, 25000),
label = c("Start of G.R.", "End of G.R.", "COVID Recession")
)
add_title <- function(vis, ..., x_lab = "X units", title = "Plot Title")
{
add_axis(vis, "x", title = x_lab) %>%
add_axis("x", orient = "top", ticks = 0, title = title,
properties = axis_props(
axis = list(stroke = "white"),
labels = list(fontSize = 0)
), ...)
}
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
#layer_lines(size = ~Dollars/Population, stroke = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines() %>%
#  layer_smooths(span = 1, stroke := "red") %>% # Our stats layer; ggvis actually defaults to LOESS
#	layer_model_predictions(model = "loess", se = TRUE) %>%
scale_numeric("y") %>% #, labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x") %>% #, breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, baseline=~label,   #Add our text annotations AFTER all other
fontSize=3 , angle=45) %>% #, stroke="black",                          #  geoms so it is on top of all other marks
#            fontface="bold", hjust = 1) +
add_title(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
x_lab = "Total [Billions], Per Capita, and Projection") #+
#  theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
#        plot.title = element_text(hjust = 0.5),          #Center chart title
#        plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
p
p
annotation <- data.frame(
Period = c("2007Q4","2009Q2", "2020Q2"),
Dollars = c(20000,10000, 25000),
label = c("Start of G.R.", "End of G.R.", "COVID Recession")
)
add_title <- function(vis, ..., x_lab = "X units", title = "Plot Title")
{
add_axis(vis, "x", title = x_lab) %>%
add_axis("x", orient = "top", ticks = 0, title = title,
properties = axis_props(
axis = list(stroke = "white"),
labels = list(fontSize = 0)
), ...)
}
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
#layer_lines(size = ~Dollars/Population, stroke = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines() %>%
#  layer_smooths(span = 1, stroke := "red") %>% # Our stats layer; ggvis actually defaults to LOESS
#	layer_model_predictions(model = "loess", se = TRUE) %>%
scale_numeric("y") %>% #, labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x") %>% #, breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, baseline=~label,   #Add our text annotations AFTER all other
fontSize=3 , angle=45) %>% #, stroke="black",                          #  geoms so it is on top of all other marks
#            fontface="bold", hjust = 1) +
add_title(title = "Nominal Gross Domestic Product",         #Add chart title, subtitle
subtitle = "Total [Billions], Per Capita, and Projection") #+
annotation <- data.frame(
Period = c("2007Q4","2009Q2", "2020Q2"),
Dollars = c(20000,10000, 25000),
label = c("Start of G.R.", "End of G.R.", "COVID Recession")
)
add_title <- function(vis, ..., x_lab = "X units", title = "Plot Title")
{
add_axis(vis, "x", title = x_lab) %>%
add_axis("x", orient = "top", ticks = 0, title = title,
properties = axis_props(
axis = list(stroke = "white"),
labels = list(fontSize = 0)
), ...)
}
p <- ggvis(gdp, x=~Period, y=~Dollars) %>% # our data and mapping layer
#  annotate("rect", xmin = '2007Q4', xmax = '2009Q2', ymin = 0, ymax = 25000, color = "orange", fill = "orange", size = 0.5, alpha=0.4) + # Our annotation layers go first!
#  annotate("pointrange", x = '2020Q2', y = 20000, xmin = '2020Q1', xmax = '2020Q2', ymin = 0, ymax = 25000, color = "red", size = 1.5, alpha=.75) +
#layer_lines(size = ~Dollars/Population, stroke = "#FC4E07", alpha = 0.5) %>%  # Our two geom line (mark) layers
layer_lines() %>%
#  layer_smooths(span = 1, stroke := "red") %>% # Our stats layer; ggvis actually defaults to LOESS
#	layer_model_predictions(model = "loess", se = TRUE) %>%
scale_numeric("y") %>% #, labels=scales::dollar_format()) %>%  # Use the "dollar_format()" function from scales (ggplot dep'cy)
scale_ordinal("x") %>% #, breaks = dates_to_show) %>% # Use the dates_to_show var we defined above to skip 20 quarters
layer_text(data=annotation, x=~Period, y=~Dollars, baseline=~label,   #Add our text annotations AFTER all other
fontSize=3 , angle=45) %>% #, stroke="black",                          #  geoms so it is on top of all other marks
#            fontface="bold", hjust = 1) +
add_title(title = "Nominal Gross Domestic Product \nTotal [Billions], Per Capita, and Projection")         #Add chart title, subtitle
#  theme(axis.text.x = element_text(angle = 45, hjust=1), #Rotate axis labels and shift to the right
#        plot.title = element_text(hjust = 0.5),          #Center chart title
#        plot.subtitle = element_text(hjust = 0.5))       #Center chart subtitle
p
p
